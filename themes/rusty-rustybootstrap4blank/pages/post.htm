title = "Post"
url = "/post"
layout = "default"
is_hidden = 0

[postform demo]
[postform todo]


[imageUploader]
maxSize = "2"
fileTypes = "png, jpg, jpeg"
deferredBinding = "1"

security = "user"
redirect = "/login"
==

<?php
use Corymillz\Adverts\Models\Cat;
use Corymillz\Adverts\Models\Advert;

function onInit()
{
    $this->imageUploader->bindModel('allimage', new Advert);
}



function onStart(){
//$this->addJs('/themes/rusty-rustybootstrap4blank/assets/js/validate/validate.js');
$this->addJs('/themes/rusty-rustybootstrap4blank/assets/js/editor/post-editor.js');
$this->addJs('/themes/rusty-rustybootstrap4blank/assets/js/location/location.js');
$this->addJs('/themes/rusty-rustybootstrap4blank/assets/js/visibility/visibility.js');


$this['items'] = Cat::where('parent_id',0)->pluck('cat_title', 'id');

}


function onChangeCat()
{

$id = post('catsId');


$this['subs'] = Cat::whereHas('parent', function ($query) use($id) {
	
 $query->where('id','=', $id );

})->pluck('cat_title', 'id'); 

return [
        '#subcategory' => $this->renderPartial('select')
    ];
	
	
}
?>
==

  {% flash %}
    <p
        data-control="flash-message"
        class="flash-message fade {{ type }}"
        data-interval="5">
        {{ message }}
    </p>
{% endflash %}


 <b><h6 align="center"  class="p-3 mb-2 text-white shadow" style="margin-top: -14px; background-color: #1484B3">Post a Product/Service</h6></b><br>



 <div class="d-block d-sm-none">
 {%partial "homescreen"%}
</div>
<div class="container" style="margin-top: -40px">
  <div class="starter-template" style="margin: -20px ">

  	

  <div class="spinner-grow " role="status" style="width: 3rem; height: 3rem; color: #1484B3" >
  <span class="sr-only">Loading...</span>
</div>


{% component 'demo' %}



</div>
</div>




<div class="modal fade" id="delectModal" tabindex="-1" role="dialog" aria-labelledby="delectModal" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered " role="document">
    <div class="modal-content">
      
      <div class="modal-body">
          <p align="center" style="font-size: 20px; font-family: arial; color: grey; font-family: arial">
           <div align="center" style="font-size: 20px" class="result">
            
          </div>
        </p>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="cancel-button">Cancel</button>
        <button type="button" class="btn btn-primary" id="okay-button">Ok</button>
      </div>
    </div>
  </div>
</div>



{% put scripts %}
<script>
    $(window).on('ajaxConfirmMessage', function(event, message) {
        // Stop the default confirm dialog
        event.preventDefault();    

        // open our own bootstrap modal
        $('#delectModal').modal('show'); 
        $(".result").html(message);

        // Okay Button. we will unbind if any events are attached to it first
        // reattach click event - this is required as this code will call each time
        $('#okay-button').unbind().click(function() {        
            // hide modal
            $('#delectModal').modal('hide'); 
            // Resolve the deferred object, this will trigger whatever was being confirmed
            event.promise.resolve();
        });

        // Cancel Button
        $('#cancel-button').unbind().click(function() {        
            // hide modal
            $('#delectModal').modal('hide'); 
            // Reject the object, this will cancel whatever was being confirmed            
            event.promise.reject();        
        });

        // Return a value so the framework knows we're handling the confirm
        return true;
    });
</script>
{% endput %}


{% put scripts %}

<script type="text/javascript">$(document).ready(function(){
    $("#myform")[0].style.visibility = "visible";
    $('.spinner-grow').hide();
});</script>

{% endput %}






